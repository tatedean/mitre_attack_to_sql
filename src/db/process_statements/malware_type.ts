import { StatementsA } from "../db.seed.js";

export const process_malware_table = (item: any,
  version: string,
  matrix: string,
  stmt: StatementsA,
  externalId: string,) => {
    stmt.malware.malware.run(
    item.id,
    version,
    matrix,
    externalId,
    item.name,
    item.description || "",
    item.revoked ? 1 : 0,
    item.x_mitre_deprecated ? 1 : 0,
  );

  if (item.x_mitre_aliases) {
    for (const alias of item.x_mitre_aliases) {
      stmt.malware.alias.run(item.id, version, matrix, alias);
    }
  }

  if (item.x_mitre_platforms) {
    for (const platform_name of item.x_mitre_platforms) {
      stmt.malware.platform.run(item.id, version, matrix, platform_name);
    }
  }
}